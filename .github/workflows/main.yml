# Test UnisynParse 2021-10-13 at 21:24:27

name: Test

on:
  push

jobs:
  test:
    runs-on: ubuntu-latest

    steps:

#    - name: Checkout Nasm::X86
#      uses: actions/checkout@v2
#      with:
#        clean: false
#        repository: philiprbrenan/NasmX86
#
#    - name: Checkout Data::Table::Text
#      uses: actions/checkout@v2
#      with:
#        clean: false
#        repository: philiprbrenan/DataTableText

    - name: Checkout repo
      uses: actions/checkout@v2
      with:
        ref: 'main'

    - name: Install Data::Table::Text
      run: |
        sudo cpan install -T Data::Table::Text GitHub::Crud Test::Most Nasm::X86

    - name: Install Nasm
      run: |
        sudo apt-get install -y nasm

    - name: Download Intel Sde
      run: |
        curl https://github.com/philiprbrenan/NasmX86/archive/refs/heads/main.zip > NasmX86.xip
        unzip NasmX86.zip
        cp -R NasmX86/* .
        tree

    - name: Install Intel Sde
      run: |
        tar -xf sde.tar.bz2
        mv sde-external-8.63.0-2021-01-18-lin/ sde/
        tree

    - name: Test
      run: |
        perl lib/Unisyn/Parse.pm
